# Прогнозирование заказов такси

## Описание проекта
Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Постройте модель для такого предсказания.
Значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

## Этапы проекта
1. Загрузим даанные 
2. Проведем анализ временного ряда: оценим ряд на стационарность при помощи теста Дики-Фуллера, оценим сезонность по дням и часам недели.
3. Создадим подвыборки и масштабируем признаки
4. Создадим и обучим модели:
   -  логистической регрессии с кроссвалидацией 
   -  дерева решений с кроссвалидацией
   -  случайного леса с кроссвалидацией
6. Проверим модель случайного леса на тестовой выборке, проанализируем модель на адекватность и ценим влияние признаков.
   
## Результат
В ходе исследовательского анализа выяснили, что:
- Среденее количество заказов - 14 заказов каждые 10 минут (т.к. данные предоставлены по 10минутным промежуткам), медиана примерно такая же - 13 заказов.
- Стандартное отклонение 9 и также по 25%- и 75% квантилям видим, что количество заказов в 10-минутные промежутки колебелется от 8 до 19. 
- Максимальное количество заказов - 119, оно наблюдалось 13августа в 2.20 ночи и 27августа в 2.10 ночи. Выглядит немного странно, если учесть ночное время в ночь на понедельник, но данное максимальное значение не сильно отличается от остальных выбросов (видим на боксплоте, что наблюдений с количеством заказов свыше 70 единичное количество), так что поверим данным.
- Дисперсия ряда со временем немного возрастает в августе. То есть, временной ряд нестационарный.
- Наименьшее количество заказов во вторники (6,13числа) и воскресенья (11,18числа)
- Наибольшее количество заказов в пятницу (9,16числа) и понедельник (12,19 числа)
- Часы максимальной нагрузки - c 21 до 4 утра (пик в 12 ночи), а также локальные пики в 10 утра и 16 часов
- Часы минимальной нагрузки - после 4 утра (минимум в 6 утра), а также локальные минимумы в 12 и в 18 часов
<br> Таким образом, существует часовая сезонность и дневная. <br> Обусловлено это, скорее всего тем, что в ночное время общественный транспорт ходит реже. Соответственно, люди чаще используют такси, чтобы добраться в аэропорт. Также, вероятно, в нерабочее время может быть больше рейсов (или, скажем, такие рейсы могут быть более популярны), соответственно, нагрузка на такси в аэропорт также увеличивается. 

<br> В набор данных добавили следующие признаки признаки:
- Календарные:
    - месяц
    - день недели
    - час был добавлен ранее
- Отстающие значения: лаги на 1-5 значений
- Скользящее среднее на 2-5 значений

<br>В качестве финальной модели выбрали модель случайного леса.
<br>**Модель случайного леса на тестовой выборке показала результат RMSE = 41,1**

**Анализ адекватности модели:**
Анализ адекватности показал, что dummy-модель и модель, предсказывающая среднее, работают гораздо хуже случайного леса, а значит, выбранная модель действительно помогает в предсказании заказов такси.

**Анализ важности признаков:**
Наиболее важными оказались признаки:
- lag_168 - спрос на такси в аналогичный день и час на прошлой неделе.
- lag_24 - в аналогичный час предыдущего дня
- hour - значение текущего часа
- lag_1 - спрос на такси в предыдущий час

Наименее важные признаки: день недели и спрос на такси в предыдущие 2-5 часов.

## Технические параметры среды
Библиотеки: pandas, numpy, statsmodels, skipy, sklearn, matplotlib, seaborn, time
<br>Версия Python: 3.9.5
