# Выбор локации для скважины

## Описание проекта
В рамках проекта для добывающей компании нужно решить, где бурить новую скважину. 
Шаги для выбора локации:
- Возьмем характеристики для скважин: качество нефти и объём её запасов;
- Построим модель для предсказания объёма запасов в новых скважинах;
- Выберем скважины с самыми высокими оценками значений;
- Определим регион с максимальной суммарной прибылью отобранных скважин.

Нам предоставлены пробы нефти в трёх регионах.
<br>Характеристики для каждой скважины в регионе уже известны.
<br>Необходимо построить модель для определения региона, где добыча принесёт наибольшую прибыль.
<br>Также нужно проанализировать возможную прибыль и риски техникой Bootstrap.

Для прогнозирования прибыли по региону используем метрика MSE.
<br>Для выбора одного из трех регионов с неоходимым соотношением прибыли и рисков используем метод Bootstrap.

## Этапы проекта
1. Загрузка данных: изучим датасеты по трем скважинам, проверим на дубликаты, удалим лишние столбцы.
2. Исследовательский анализ данных: построим матрицу корреляций и парные графики корреляций. 
3. Создадим и обучим модели по каждому региону:
    - разработаем функция для создания и обучения модели линейной регрессии - *learn_check_model*
    - разработаем функция для оценки прибыли по региону - *revenue*
    - разработаем функция для оценки прибыли и рисков - *bootstrap_revenue*
4. Проведем оценку прибыли и рисков по каждому региону, выбран регион, подходящий под условия задачи.

## Результат

<br>**В ходе подготовки данных сделали:**
- данные по трем регионам загрузили в отельные таблицы для анализа
- проверили пропуски в данных, дубликаты
- удалили лишние столбцы (id скважины)

<br>**В ходе первичного анализа выяснили, что:**
<br> Во всех трех датасетах находят разные по структуре зависимостей данные. Поэтому для каждого датасета необходимо обучать собственную модель. В качестве модели для всех трех датасетов использовали линейную регрессию.
<br> По данным в датасетах сделали следующие выводы:
- для Data0:
    - сильной взаимной корреляции между признаками(f0,f1,f2) не обнаружено
    - наивысшая корреляция с целевым признаком (Product) обнаружена у признака f2 (0.483)
    - несмотря на то, что по показателю корреляции f0иf1 значение 0,44 (средний уровень), на графике мы видим, что однозначно есть некая зависимость - график напоминает спираль или две противоположно направленные параболы.
    - видна положительная корреляция между f2 и Product, но с большим размахом точек.
    - по f0 vs Product и f1 vs Product тоже интересные графики: напоминают два наложенных прямоугольника с довольно четкими границами. 
    - Можно осторожно предпложить, что внутри датасета как-будто выделяются две подвыборки с разным поведением признаков f0 и f1 между собой и с вот такими примерными границами:
        - 1) со значением f0 [-1:1], f1 [-0.2:1.5] - Product [0:175] 
        - 2) со значением f0 [0:2], f1 [-1:0,75] - Product [25:200] 

- для Data1:
    - найдена мультиколлинеарность между признаком f2 и Product (корреляция = 0,999).
    - между остальными парами признаков корреляция не превышает 0,182
    - признаки f2 и Product имеют очень небольшое ограниченное количество уникальных значений
    - корреляции между f0 и f1 не наблюдается, при этом значения разбросаны равномерно от-20 до 20.

- для Data2:
    - нет корреляции между признаками(f0,f1,f2) 
    - небольшая корреляция с целевым признаком (Product) обнаружена у признака f2 (0.445) (с большим разбросом точек)
    - f0,f1,f2 распределены симметрично и колоколообразно

<br>**В ходе обучения модели были сделано:**
- разработана общая функция, позволяющая подвать на вход один из трех датасетов и обучать модель по каждому из них
- данные прогнозов в ходе обучения модели сохраняются в отдельную таблицу для дальнейшего анализа
- для каждого из датасетов была обучена модель линейной регрессии и получены следущие показатели:
- Для Data0:
    - RMSE модели линейной регрессии на валидационной выборке: 37.58
    - Средний запас сырья на валидационной выборке (по предсказаниям): 92.59
- Для Data1:
    - RMSE модели линейной регрессии на валидационной выборке: 0.89
    - Средний запас сырья на валидационной выборке (по предсказаниям): 68.73
- Для Data2:
    - RMSE модели линейной регрессии на валидационной выборке: 40.03
    - Средний запас сырья на валидационной выборке (по предсказаниям): 94.97 

<br>Судя по среднему запасу сырья, наиболее хорошим кажется регион Data2. Однако, в ходе подготовки к расчету прибыли было выявлено, что для безубыточного проекта нефтяные скважины должны содержать в среднем 111 единиц нефти. Неутешительно, но, нам нужны только 200 лучших точек из всего региона, а их показатели могут сильно отличаться от среднего по всему региону.

<br>**В ходе подготовки к расчету прибыли было сделано:**
- рассчитано среднее значение объема нефти, необходимое для безубыточного проекта (111 единиц).
- была разработана функция, которая подсчитывает реально получаемую прибыль в зависимости от выбора точек исходя из спрогнозированных значений 

<br>**В ходе расчета прибыли и рисков:**
<br>В ходе расчета прибыли и рисков было выявлено, что наиболее удачным регионом для разработки является регион Data1, так как только по этому региону риск убытков менее 2,5% (а точнее равен 0,93%). По двум другим регионам риск убытка 6,2%. Стоит однако помнить, что наилучшие точки мы выбирали по предсказаниям модели. Соответственно, есть также риск, что полученное распределение прибыли может быть занижено или завышено относительного истинного распределения прибыли в связи с недостаточным качеством обученной модели.

## Технические параметры среды
Библиотеки: pandas, numpy, matplotlib, seaborn, sklearn, scipy
<br>Версия Python: 3.9.5

