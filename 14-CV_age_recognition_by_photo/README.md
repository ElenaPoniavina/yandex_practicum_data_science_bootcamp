
# Определение возраста человека по фото 

## Описание проекта
**Задача:** 
Сетевой супермаркет внедряет систему компьютерного зрения для обработки фотографий покупателей. 
<br> Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:
- Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
- Контролировать добросовестность кассиров при продаже алкоголя.

**Данные:** в нашем распоряжении набор фотографий людей с указанием возраста.
<br>**Необходимо:** построить модель, которая по фотографии определит приблизительный возраст человека.

## Этапы проекта
1. Загрузим данные при помощи tensorflow
2. Исследовательский анализ данных: оценим общий объем выборки, выведем примеры изображений, оценим распределения возрастов в датасете
3. Разработаем функции для создания и обучения модели
   - load_train(path) - функция для загрузки обучающих данных
   - load_test(path) - функция для загрузки тестовых данных
   - create_model(input_shape) - функция для создания модели
   - train_model(model, train_data, test_data, batch_size=None, epochs=10,steps_per_epoch=None, validation_steps=None) - функция для обучения модели
4. Запустили функции и оценили результат
Так как запуск функций производился на отдельной среде с GPU (а не в Jupiter Notebook), то в Jupiter были вставлены уже результаты работы функций.  

## Результат
**В ходе анализа исходного набора данных:**
- мы загрузили библиотеку фотографий и каждое фото сопоставили с соответствующим ей возрастом. 
- обнаружили, что:
   - датасет содержит 7591 фотографию с возрастом. 
   - возраст хранится в числовом формате и не содержит отсутствующих значений.
   - минимальный возраст в выборке - 1 год, максимальный - 100 лет.
   - медиана по возрасту  в выборке - 29 лет, среднее - 31год. 

Также вывели примеры фотографии и возраста для проверки корректности загрузки.
<br>Обнаружили, что распределение приближенно похоже на нормальное, но скошено влево. 
<br> При этом в районе возраста 10 лет видим провал в данных относительно соседних возрастов. 
<br>То есть, данных по 10летним детям немного относительно, например, 20-летних людей.
<br>Но у нас есть много детских фотографий - это хорошо, так как в возрасте до 10 лет лица меняются очень быстро и образцов должно быть достаточно.

**В ходе разработки модели:**
- разработали функции загрузки данных, создания и обучения модели:
    - load_train
    - load_test
    - create_model
    - train_model

При построении модели для предсказания возраста по фотографии использовали архитектуру ResNet50 с удалением верхнего слоя и добавлением двух дополнительных слоев:
- пуллинг GlobalAveragePooling2D
- финальный полносвязный Dense-слой с одним выходным нейроном и функцией активации 'linear' (т.к. стояла задача регрессии) 

Также в качестве потерь выбрали метрику MSE, а в качестве финальной метрики - MAE.
<br>Именно эта архитектура позволила достичь метрики MAE<7.
<br>**Финальная метрика на валидационной выборке составила: MAE=6.3**

## Технические параметры среды
Библиотеки: pandas, numpy, matplotlib, tensorflow
<br>Версия Python: 3.9.5
