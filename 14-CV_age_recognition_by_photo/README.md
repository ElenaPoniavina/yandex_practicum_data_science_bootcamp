
# Определение возраста человека по фото 

## Описание проекта
**Задача:** 
Сетевой супермаркет внедряет систему компьютерного зрения для обработки фотографий покупателей. 
<br> Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:
- Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
- Контролировать добросовестность кассиров при продаже алкоголя.

**Данные:** в нашем распоряжении набор фотографий людей с указанием возраста.
<br>**Необходимо:** построить модель, которая по фотографии определит приблизительный возраст человека.

## Этапы проекта
1. Загрузим данные при помощи tensorflow
2. Исследовательский анализ данных: оценим общий объем выборки, выведем примеры изображений, оценим распределения возрастов в датасете
3. Разработаем функции для создания и обучения модели
   - load_train(path) - функция для загрузки обучающих данных
   - load_test(path) - функция для загрузки тестовых данных
   - create_model(input_shape) - функция для создания модели
   - train_model(model, train_data, test_data, batch_size=None, epochs=10,steps_per_epoch=None, validation_steps=None) - функция для обучения модели
4. Запустим функции и оценим результат
Так как запуск функций производился на отдельной среде с GPU (а не в Jupiter Notebook), то в Jupiter были вставлены уже результаты работы функций.  

## Результат
При построении модели для предсказания возраста по фотографии была использована архитектура ResNet50 с удалением верхнего слоя и добавлением двух дополнительных слоев:
- пуллинг GlobalAveragePooling2D
- финальный полносвязный Dense-слой с одним выходным нейроном и функцией активации 'linear' (т.к. стояла задача регрессии)
Также в качестве потерь мы выбрали метрику MSE, а в качестве финальной метрики - MAE.
Именно эта архитектура позволила достичь метрики MAE<7.

**Финальная метрика на валидационной выборке составила: MAE=6.3**
