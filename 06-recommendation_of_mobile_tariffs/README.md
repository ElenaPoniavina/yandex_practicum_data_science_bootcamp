# Рекомендация мобильных тарифов

## Описание проекта
В нашем распоряжении данные о поведении клиентов на разных мобильных тарифах.
<br>Построим модель для задачи классификации, которая выберет подходящий тариф.
<br>Предобработка данных не понадобится (данные уже подготовлены).

<br>Построим модель с максимально большим значением accuracy.
<br>Требование: нужно довести долю правильных ответов по крайней мере до 0.75.

## Этапы проекта
1. Загрузим и проведем предобработку данных: исправим типы данных, проанализируем пропуски и дубликаты, создадим новые столбцы.
2. Проведем исследовательский анализ: изучим длительность и количество звонков, количество сообщений и испльзуемый объем интернета.
5. Обучим три вида модели: модель дерева, случайного леса и логистической регрессии.
7. Сформулируем общие выводы
   
## Результат
<br>В рамках изучения данных были проанализированы показатели количества и длительности звонков, количества сообщений и используемого интернета для пользователей Ультра, Смарт, а также по всей выборке.
<br>Для обучения полученный набор данных был разделе на 3 выборки: обучающую, валидационую и тестовую.
<br>В процессе анализа были обучены три типа моделей:
- модель решающего дерева
- модель случайного леса
- модель логистической регрессии

<br>После проверки обученных моделей на валидационной выборке были получены следующие результаты:
- модель решающего дерева: наиболее успешным оказалось дерево с глубиной 3,  accuracy = **0.7853.**
- модель случайного леса: наилучшая модель с параметрами кол-во деревьев = 12 , макс. глубина дерева = 6, accuracy = **0.8040**
- модель логистической регрессии: accuracy = **0.7107**
<br>Таким образом, наилучший результат был получен по модели случайного леса - accuracy = **0.8040**

<br>Также было выявлено, что небольшая часть пользователей нелогично используют взятый тариф. В качестве таких пользователей были выделены:
- пользователи Ультра, у которых каждая фича меньше медианы по тарифу Смарт (при таких условиях им точно выгоднее взять Смарт)
- пользователи Смарт, у которых каждая фича больше медианы по тарифу Ультра (при таких условиях им выгоднее взять Ультра)

<br>Так как цель модели - предложить новому пользователю наиболее выгодный тариф (а не предсказать выбор будущих пользователей), то советы модели должны быть логичными.
<br> В качестве эксперимента из обучающей выборки были удалены нелогичные пользователи. А затем были также изучены все три типа моделей. КАкие результаты были получены:
- модель решающего дерева: наиболее успешным оказалось дерево с глубиной 7,  accuracy = **0.8234.**
- модель случайного леса: наилучшая модель с параметрами кол-во деревьев = 12 , макс. глубина дерева = 8, accuracy = **0.8366**
- модель логистической регрессии: accuracy = **0.7722**
<br> В целом показатели по моделям стали немного лучше, чем до очистки данных. Наилучший результат был получен по модели случайного леса - accuracy = **0.8366**

<br>На этапе тестирования обе модели случайного леса (основная модель и экспериментальная) были протестированы на одной и той же тестовой выборке данных. Полученные результаты:
- основная модель: accuracy = **0.7978**
- экспериментальная модель: accuracy = **0.8724**

<br>Полученная экспериментальная модель оказалась немного лучше основной.
<br>Таким образом, мы получили модель, которая с вероятностью 87% может посоветовать пользователю удобный тариф.

## Технические параметры среды
Библиотеки: pandas, numpy, sklearn, matplotlib, seaborn
<br>Версия Python: 3.9.5


