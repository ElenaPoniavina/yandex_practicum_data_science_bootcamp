
# Исследование технологического процесса очистки золота

## Описание проекта
Компания X разрабатывает решения для эффективной работы промышленных предприятий.
<br>Необходимо разработать модель, которая должна предсказать коэффициент восстановления золота из золотосодержащей руды. 
<br>В качестве исходных данных используются данные с параметрами добычи и очистки.
<br>Модель должна помочь оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.
<br>Оценка модели производится на основе функции SMAPE (Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»)

## Этапы проекта
1. Загрузим данные: проверим датасет на ошибки, обработаем пропуски, дубликаты, скорректируем типы данных.
2. Исследовательский анализ данных: оценим концентрацию металлов на разных стадиях (детальная и суммарная конц-я), оценим размеры гранул сырья.
3. Создадим и обучим модели:
  - разработаем функцию для оценки модели - SMAPE
  - оценим модель линейной регрессии
  - оценим модель решающего дерева (с подбором параметров в цикле и через GridSearchCV)
4. Протестируем лучшую моделб (модель дерева) на тестовой выборке. Проверим модель на адекватность.

## Результат

<br>**В ходе подготовки данных сделали:**
- проверили предоставленную эффективность обогащения (recovery)
- проанализировали признаки в трех наборах данных
- проанализировали идентичность приведнных данных между наборами
- обработали (удалили) пропуски
- проверили дубликаты (их не оказалось)
- отредактировали типы данных (поле date приведено к типу datetime)

<br>**В ходе исследовательского анализа сделали:**
- изучили концентрацию золота,серебра и свинца на каждой стади обогащения:
    - концентрация золота с каждым этапом возрастает
    - концентрация серебра после флотации немного увеличивается, а затем уменьшается
    - концентрация свинца незначительно возрастает
- выявили, что разброс значений по уровню каждого металла в сырье становится меньше, то есть в исходном сырье может встречатся разный уровень содержания того или иного металла, но в процессе обработки он чаще всего сводится к узкому интервалу значений.
- выявили, что распределения размера гранул в тренировочной и тестовой выборке в целом похожи на друг друга, так что поводов сомневаться в оценке модели нет.
- выявили, что с каждой итерацией общая концентрация металлов также возрастает.

<br>**В ходе обучения модели сделали:**
- подготовили  функцию для рассчета метрики качества модели - sMAPE - симметричное среднее абсолютное процентное отклонение
- подготовили и обучили модели линейной регрессии:
    - Наименьшая оценка sMAPE для флотации на линейной регрессии: -0.3728224770239428
    - Наименьшая оценка sMAPE для финального процесса на линейной регрессии: -0.1202355958861157
    - Итоговая оценка sMAPE на модели линейной регрессии: -0.18338231617057246
- подготовили и обучили модели регрессии на решающем дереве:
    - Наименьшая оценка sMAPE для флотации на модели дерева c глубиной: 38 -7.494399770661309
    - Наименьшая оценка sMAPE для всего процесса на модели дерева c глубиной: 38 -2.426709541675414
    - Итоговая оценка sMAPE на модели дерева: -3.6936320989218876
- в качестве лучшей модели выбрали модель решающего дерева с глубиной 38 и протестировали ее на тестовой выборке:
    - Оценка sMAPE для флотации на модели дерева c глубиной 38: -1.9573315658015094
    - Оценка sMAPE для всего процесса на модели дерева c глубиной 38: -1.5178675514512716
    - Итоговая оценка sMAPE на модели дерева для тестовой выборки: -1.6277335550388312

**Таким образом, итоговая метрика качества модели на тестовой выборке равна -1.62%**

## Технические параметры среды
Библиотеки: pandas, numpy, matplotlib, seaborn, skipy, sklearn
<br>Версия Python: 3.9.5
